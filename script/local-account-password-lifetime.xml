<?xml version="1.0"?>
<Plugin name="Local_Account_Password_lifetime">
    <PluginVersion>1</PluginVersion>
    <PluginName>local-account-password-lifetime.xml</PluginName>
    <TargetOS>Windows</TargetOS>
    <Result_Type>action</Result_Type>
    <Info>컴퓨터 계정 암호 최대 사용 기간 설정 여부 점검</Info>
    <Description>컴퓨터 계정 암호 최대 사용 기간을 설정하기 위함</Description>
    <Commands>
        <CommandCount>1</CommandCount>
        <Command>
            <CommandName>Local_Account-Password_Lifetime</CommandName>
            <CommandType>Powershell</CommandType>
            <CommandString>powershell.exe -Command "$MaxPasswordAge=90;$SecPolFile=\\"$env:temp\SecPol.cfg\\";secedit /export /cfg $SecPolFile;(Get-Content $SecPolFile -Raw) -replace \'MaximumPasswordAge = \\d+\',\\"MaximumPasswordAge = $MaxPasswordAge\\" | Set-Content $SecPolFile;secedit /configure /db secedit.sdb /cfg $SecPolFile /areas SECURITYPOLICY;Start-Sleep -Seconds 2;$Result = if((Get-Content $SecPolFile -Raw) -match \'MaximumPasswordAge = (\d+)\') {if($Matches[1] -eq $MaxPasswordAge) {\'True\'} else {\'False\'}};Remove-Item $SecPolFile;Write-Output $Result"</CommandString>
        </Command>
    </Commands>
</Plugin>
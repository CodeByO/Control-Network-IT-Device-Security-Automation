<?xml version="1.0"?>
<Plugin name="Local_Account_Password_lifetime">
    <PluginVersion>1</PluginVersion>
    <PluginName>local-account-password-lifetime.xml</PluginName>
    <TargetOS>Windows</TargetOS>
    <Result_Type>action</Result_Type>
    <Info>컴퓨터 계정 암호 최대 사용 기간 설정 여부 점검</Info>
    <Description>컴퓨터 계정 암호 최대 사용 기간을 설정하기 위함</Description>
    <Commands>
        <CommandCount>1</CommandCount>
        <Command>
            <CommandName>Local_Account-Password_Lifetime</CommandName>
            <CommandType>Powershell</CommandType>
            <CommandString>secedit /export /cfg $env:temp\secpol.cfg; (Get-Content $env:temp\secpol.cfg -Raw).Replace('PasswordAge=0', 'PasswordAge=90').Replace('ClearTextPassword=0', 'ClearTextPassword=1') | Set-Content $env:temp\secpol.cfg; secedit /configure /db secedit.sdb /cfg $env:temp\secpol.cfg /areas SECURITYPOLICY; Remove-Item $env:temp\secpol.cfg</CommandString>
        </Command>
    </Commands>
</Plugin>
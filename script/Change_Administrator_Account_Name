<?xml version="1.0"?>
<Plugin name="Windows_Security_Plugin">
    <PluginVersion>1</PluginVersion>
    <PluginName>Change_Administrator_Account_Name.xml</PluginName>
    <TargetOS>Windows</TargetOS>
    <Result_Type>action</Result_Type>
    <Info>Administrator 계정 이름 변경</Info>
    <Description>Administrator 계정 이름을 유추하기 어려운 계정 이름으로 변경</Description>
    <Commands>
        <CommandCount>1</CommandCount>
        <Command>
            <CommandName>Change_Administrator_Account_Name</CommandName>
            <CommandType>Powershell</CommandType>
            <CommandString>
		$TokenSet = @{
			U = [Char[]]'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
			L = [Char[]]'abcdefghijklmnopqrstuvwxyz'
			N = [Char[]]'0123456789'
		}

		$Upper = Get-Random -Count 5 -InputObject $TokenSet.U
		$Lower = Get-Random -Count 5 -InputObject $TokenSet.L
		$Number = Get-Random -Count 5 -InputObject $TokenSet.N

		$StringSet = $Upper + $Lower + $Number

		$pwd = -join (Get-Random -Count 8 -InputObject $StringSet)
		Start-Process PowerShell "-Command Rename-LocalUser -Name Administrator -NewName $pwd" -Verb RunAs
	    </CommandString>
        </Command>
    </Commands>
</Plugin>
